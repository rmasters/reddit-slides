<html>
<head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {        
            function Rotator() {
                this.interval = 300;
                this.image = 0;
                this.images = undefined;
                
                this.Fetch();
                //this.count = this.images.length;
            }
            
            Rotator.prototype.constructor = function() {
                console.log("Constructed");
                this.Fetch();
            }
            
            Rotator.prototype.Fetch = function() {
                console.log("Fetch called");
                $.getJSON("./data.php?callback=?", function (data) {
                    console.log(data.images);
                    this.images = data.images;
                });
            }
            
            Rotator.prototype.Count = function() {
                //return this.images.Length;
            }
            
            Rotator.prototype.Current = function() {
                if (this.images == undefined) {
                    this.Fetch();
                }
                return this.images[this.image];
            }
            
            Rotator.prototype.Next = function() {
                this.image++;
            }
            
            r = new Rotator;
            console.log(r.Current());
            
            //setTimeout("rotate()", interval);
            
            /*function rotate() {
                var image = images[current];
                
                $("#image").fadeOut(400);
                
                $("#image").empty();
                        
                var link = $("<a>").attr("href", image.link)
                                .attr("title", image.title);
                var img = $("<img>").attr("src", image.url);
                var descr = $("<p>").text("Posted by " + image.author);
                
                $("#image").append(
                    $("<p>").append(
                        link.append(img)
                    )
                ).append(descr); 
                
                $("#image").fadeIn(400);
                
                current++;
            }
            
            rotate();*/
            
            rotator.next();
        });
    </script>
</head>
<body>
    <h1>Reddit Slideshow</h1>
    <div id="image"></div>
</body>
</html>